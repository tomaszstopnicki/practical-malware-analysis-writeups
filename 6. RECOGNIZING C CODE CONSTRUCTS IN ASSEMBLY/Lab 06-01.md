## Lab 06-01

In this lab, you will analyze the malware found in the file Lab06-01.exe

## 1. What is the major code construct found in the only subroutine called by main?

The main:

![image](https://github.com/user-attachments/assets/05f66e0b-4de7-4572-a1a6-a97cc268fd23)

At the very beginning the program starts with a call to sub_401000.

![image](https://github.com/user-attachments/assets/d14bd9c9-bfd0-49cd-9dc3-e5021ffcc448)

The construct found in the subroutine clearly points to if statement.

We can see that call to InternetGetConnectedState which returns either 1 or 0 (true or false), and then it is being compared with these values to proceed further dependent upon the result.


## 2. & 3.
## What is the subroutine located at 0x40105F? 
## What is the purpose of this program?

Let’s examine the path where the subroutine at 0x40105F gets called.

![image](https://github.com/user-attachments/assets/1afbdd54-4d7c-4fdb-b35e-4fe7b3170a64)


It gets called twice, just before pushing one of two strings into the stack.

Let’s take a look at the sub_40105F itself:

![image](https://github.com/user-attachments/assets/64c81637-43a3-4f92-b6f9-e3624784ac3b)


This code doesn’t tell much, we have two arguments on the beginning, then a call to setbuf (_stbuf) which controls stream buffering, then we can see arg_0 and arg_4 being pushed into the stack and then another call to sub_401282 is being made.

With each deeper analysis it’s getting more and more complicated. I can guess that call to sub_40105F after a string value pushed into the stack results in sending/printing this message somewhere. 

Let’s try to execute this program.

![image](https://github.com/user-attachments/assets/dd868066-34ae-4bdf-8d75-a148334457e0)


As we can see, the application prints the information about network connection dependent on current state.
