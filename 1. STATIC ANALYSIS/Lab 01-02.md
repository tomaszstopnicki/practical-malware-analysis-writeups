## **Lab 01-02**

## 1. Upload the Lab01-02.exe file to VirusTotal. Does it match any existing antivirus definitions?

**MD5:** `8363436878404da0ae3e46991e355b83`

**SHA-256:** `c876a332d7dd8da331cb8eee7ab7bf32752834d4b2b54eaa362674a2a48f64a6`

Yes, the file matches several antivirus definitions. Currently 59/73.

## 2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

- CFF Explorer tells us that it is packed with UPX v3.0.
- Section headers show us: UPX0, UPX1, UPX2 instead of .text, .rdata, .data etc.
- It doesn’t show us any valid strings.

**Unpacked the compressed file using command upx -d**

## 3. Do any imports hint at this program’s functionality? If so, which imports are they and what do they tell you?

Static analysis tells us that there are 4 libraries:

**1) KERNEL32.dll**
- SystemTimeToFileTime – converts a system time to file time format.
- GetModuleFileNameA  - returns name of the modle file loaded in the current process. Malware can use that function to modificate or to copy files during the current process.
- CreateWaitableTimerA - creates a timer function, might be used for settings some time intervals for ie. to reach a specific network.
- SetWaitableTimer – sets a timer, as above.
- ExitProcess
- CreateMutexA – creates a mutex attach for making sure only one instance of malware is currently running at the time.
- OpenMutexA – as above.
- WaitForSingleObject - waits until the specified object is in the signaled state or the time-out interval elapses.
- CreateThread – creates a new thread for a process.


**2) ADVAPI32.dll**
- CreateServiceA – function used mostly for reopening the malware during system startup.
- StartServiceCtrlDispatcherA – used by malware to act like a service making it harder to be found. Also being a service provides more rights.
- OpenSCManagerA – hooking service function, same as above.


**3) MSVCRT.dll** – the file is related to Microsoft C Runtime Library. The file loads modules for Visual C and C++ programs.


**4) WININET.dll** – library used for accessing the Internet.
- InternetOpenUrlA – opens a specific address URL in order to connect by FTP or HTTP. 
- InternetOpenA – high-leveled access function to access the Internet.


## 4. What host- or network-based indicators could be used to identify this malware on infected machines?

I have found strings that are **‘HGL345’**, **‘MalService’**, **‘Malservice’** those might be indicators that the malware might be a service we should look for.

Network-based indicator might be connection to the specific URL address - <http://www.malwareanalysisbook.com>.

User-agent is a **‘Internet Explorer 8.0’**

